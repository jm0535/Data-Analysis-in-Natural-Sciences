<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Hypothesis Testing – Data Analysis in Natural Sciences: An R-Based Approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/05-statistical-tests.html" rel="next">
<link href="../chapters/03-exploratory-analysis.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-a0649ace7b9e9e15dfb5fe311d767a49.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-494121dfa8658343c03537e94414993d.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-dark-6c5314280c86e53d2a1a2ca4c5fd5b4a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-6c5314280c86e53d2a1a2ca4c5fd5b4a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/04-hypothesis-testing.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Data Analysis in Natural Sciences: An R-Based Approach</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jm0535/Data-Analysis-in-Natural-Sciences/tree/main" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About This Book</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-data-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Basics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Analysis Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-exploratory-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-hypothesis-testing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-statistical-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-advanced-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-conservation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Conservation Applications</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#the-logic-of-hypothesis-testing" id="toc-the-logic-of-hypothesis-testing" class="nav-link" data-scroll-target="#the-logic-of-hypothesis-testing"><span class="header-section-number">4.2</span> The Logic of Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#null-and-alternative-hypotheses" id="toc-null-and-alternative-hypotheses" class="nav-link" data-scroll-target="#null-and-alternative-hypotheses"><span class="header-section-number">4.2.1</span> Null and Alternative Hypotheses</a></li>
  <li><a href="#example-in-ecological-research" id="toc-example-in-ecological-research" class="nav-link" data-scroll-target="#example-in-ecological-research"><span class="header-section-number">4.2.2</span> Example in Ecological Research</a></li>
  </ul></li>
  <li><a href="#understanding-p-values-and-significance-levels" id="toc-understanding-p-values-and-significance-levels" class="nav-link" data-scroll-target="#understanding-p-values-and-significance-levels"><span class="header-section-number">4.3</span> Understanding P-values and Significance Levels</a>
  <ul class="collapse">
  <li><a href="#the-p-value" id="toc-the-p-value" class="nav-link" data-scroll-target="#the-p-value"><span class="header-section-number">4.3.1</span> The P-value</a></li>
  <li><a href="#significance-level-α" id="toc-significance-level-α" class="nav-link" data-scroll-target="#significance-level-α"><span class="header-section-number">4.3.2</span> Significance Level (α)</a></li>
  </ul></li>
  <li><a href="#types-of-errors-in-hypothesis-testing" id="toc-types-of-errors-in-hypothesis-testing" class="nav-link" data-scroll-target="#types-of-errors-in-hypothesis-testing"><span class="header-section-number">4.4</span> Types of Errors in Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#type-i-and-type-ii-errors" id="toc-type-i-and-type-ii-errors" class="nav-link" data-scroll-target="#type-i-and-type-ii-errors"><span class="header-section-number">4.4.1</span> Type I and Type II Errors</a></li>
  <li><a href="#experimental-design" id="toc-experimental-design" class="nav-link" data-scroll-target="#experimental-design"><span class="header-section-number">4.4.2</span> Experimental Design</a></li>
  </ul></li>
  <li><a href="#common-hypothesis-tests-in-ecological-research" id="toc-common-hypothesis-tests-in-ecological-research" class="nav-link" data-scroll-target="#common-hypothesis-tests-in-ecological-research"><span class="header-section-number">4.5</span> Common Hypothesis Tests in Ecological Research</a></li>
  <li><a href="#example-two-sample-t-test" id="toc-example-two-sample-t-test" class="nav-link" data-scroll-target="#example-two-sample-t-test"><span class="header-section-number">4.6</span> Example: Two-Sample t-test</a></li>
  <li><a href="#example-using-marine-dataset-for-two-sample-t-test" id="toc-example-using-marine-dataset-for-two-sample-t-test" class="nav-link" data-scroll-target="#example-using-marine-dataset-for-two-sample-t-test"><span class="header-section-number">4.7</span> Example: Using Marine Dataset for Two-Sample t-test</a></li>
  <li><a href="#one-sample-t-test" id="toc-one-sample-t-test" class="nav-link" data-scroll-target="#one-sample-t-test"><span class="header-section-number">4.8</span> One-Sample t-test</a></li>
  <li><a href="#paired-t-test" id="toc-paired-t-test" class="nav-link" data-scroll-target="#paired-t-test"><span class="header-section-number">4.9</span> Paired t-test</a></li>
  <li><a href="#testing-assumptions-normality" id="toc-testing-assumptions-normality" class="nav-link" data-scroll-target="#testing-assumptions-normality"><span class="header-section-number">4.10</span> Testing Assumptions: Normality</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">4.11</span> Confidence Intervals</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.12</span> Summary</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">4.13</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/03-exploratory-analysis.html">Data Analysis Fundamentals</a></li><li class="breadcrumb-item"><a href="../chapters/04-hypothesis-testing.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">4.1</span> Introduction</h2>
<p>Hypothesis testing is a fundamental statistical approach used to make inferences about populations based on sample data. In ecological and forestry research, hypothesis testing helps researchers determine whether observed patterns or differences are statistically significant or merely due to random chance.</p>
</section>
<section id="the-logic-of-hypothesis-testing" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="the-logic-of-hypothesis-testing"><span class="header-section-number">4.2</span> The Logic of Hypothesis Testing</h2>
<section id="null-and-alternative-hypotheses" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="null-and-alternative-hypotheses"><span class="header-section-number">4.2.1</span> Null and Alternative Hypotheses</h3>
<p>The foundation of hypothesis testing involves two competing hypotheses:</p>
<ol type="1">
<li><p><strong>Null Hypothesis (H₀)</strong>: This is the default position that assumes no effect, no difference, or no relationship exists. For example, “There is no difference in tree height between two forest types.”</p></li>
<li><p><strong>Alternative Hypothesis (H₁ or Hₐ)</strong>: This is the hypothesis that the researcher typically wants to provide evidence for. For example, “There is a significant difference in tree height between two forest types.”</p></li>
</ol>
</section>
<section id="example-in-ecological-research" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="example-in-ecological-research"><span class="header-section-number">4.2.2</span> Example in Ecological Research</h3>
<p>Let’s consider a specific example from forestry research:</p>
<ul>
<li><strong>Research Question</strong>: Is there a difference in the average height of oak trees between Site A and Site B?</li>
<li><strong>Null Hypothesis (H₀)</strong>: There is no difference in the average height of oak trees between Site A and Site B.</li>
<li><strong>Alternative Hypothesis (H₁)</strong>: There is a significant difference in the average height of oak trees between Site A and Site B.</li>
</ul>
</section>
</section>
<section id="understanding-p-values-and-significance-levels" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="understanding-p-values-and-significance-levels"><span class="header-section-number">4.3</span> Understanding P-values and Significance Levels</h2>
<section id="the-p-value" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="the-p-value"><span class="header-section-number">4.3.1</span> The P-value</h3>
<p>The p-value is the probability of obtaining results at least as extreme as the observed results, assuming that the null hypothesis is true. In simpler terms, it measures the strength of evidence against the null hypothesis.</p>
<ul>
<li>A small p-value (typically ≤ 0.05) indicates strong evidence against the null hypothesis, leading to its rejection.</li>
<li>A large p-value (&gt; 0.05) indicates weak evidence against the null hypothesis, leading to a failure to reject it.</li>
</ul>
</section>
<section id="significance-level-α" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="significance-level-α"><span class="header-section-number">4.3.2</span> Significance Level (α)</h3>
<p>The significance level, often denoted as α (alpha), represents the threshold for statistical significance. In most research, it is set at 0.05 (5%). This value signifies the maximum acceptable probability of making a Type I error — wrongly rejecting the null hypothesis when it is true.</p>
</section>
</section>
<section id="types-of-errors-in-hypothesis-testing" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="types-of-errors-in-hypothesis-testing"><span class="header-section-number">4.4</span> Types of Errors in Hypothesis Testing</h2>
<section id="type-i-and-type-ii-errors" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="type-i-and-type-ii-errors"><span class="header-section-number">4.4.1</span> Type I and Type II Errors</h3>
<p>In hypothesis testing, two types of errors can occur:</p>
<ol type="1">
<li><strong>Type I Error</strong>: Rejecting a true null hypothesis (false positive).
<ul>
<li>Probability = α (significance level)</li>
<li>Example: Concluding there’s a difference in tree heights when there actually isn’t.</li>
</ul></li>
<li><strong>Type II Error</strong>: Failing to reject a false null hypothesis (false negative).
<ul>
<li>Probability = β</li>
<li>Example: Failing to detect a real difference in tree heights.</li>
</ul></li>
</ol>
</section>
<section id="experimental-design" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="experimental-design"><span class="header-section-number">4.4.2</span> Experimental Design</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PROFESSIONAL TIP: Improving Statistical Power
</div>
</div>
<div class="callout-body-container callout-body">
<p>To reduce Type II errors and increase the power of your study:</p>
<ul>
<li>Increase sample size: Larger samples provide more precise estimates and greater power</li>
<li>Reduce measurement variability: Use standardized protocols and calibrated instruments</li>
<li>Use paired or repeated measures designs when appropriate: These control for individual variation</li>
<li>Conduct a power analysis before data collection: This helps determine the minimum sample size needed</li>
<li>Consider using one-tailed tests when appropriate: These provide more power than two-tailed tests when the direction of effect is known</li>
<li>Report confidence intervals: These provide information about effect size and precision</li>
</ul>
</div>
</div>
</section>
</section>
<section id="common-hypothesis-tests-in-ecological-research" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="common-hypothesis-tests-in-ecological-research"><span class="header-section-number">4.5</span> Common Hypothesis Tests in Ecological Research</h2>
</section>
<section id="example-two-sample-t-test" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="example-two-sample-t-test"><span class="header-section-number">4.6</span> Example: Two-Sample t-test</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate tree height data for two sites</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>site_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>)  <span class="co"># 30 trees with mean height 25m</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>site_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">28</span>, <span class="at">sd =</span> <span class="dv">5</span>)  <span class="co"># 30 trees with mean height 28m</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>tree_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">c</span>(site_A, site_B),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">30</span>))</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the data</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tree_data, <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> height, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tree Heights by Site"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Site"</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height (m)"</span>) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-hypothesis-testing_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a t-test</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(height <span class="sc">~</span> site, <span class="at">data =</span> tree_data)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  height by site
t = -3.5092, df = 56.559, p-value = 0.0008892
alternative hypothesis: true difference in means between group A and group B is not equal to 0
95 percent confidence interval:
 -6.482713 -1.771708
sample estimates:
mean in group A mean in group B 
       24.76448        28.89169 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpret the result</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (t_test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"With a p-value of"</span>, <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"we reject the null hypothesis.</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"There is a statistically significant difference in tree heights between sites."</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"With a p-value of"</span>, <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"we fail to reject the null hypothesis.</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"There is not enough evidence to conclude a significant difference in tree heights."</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>With a p-value of 9e-04 we reject the null hypothesis.
 There is a statistically significant difference in tree heights between sites.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(t_test_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">diff</span>(t_test_result<span class="sc">$</span>estimate), <span class="dv">2</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(t_test_table, </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Two-Sample t-Test Results: Tree Heights by Site"</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Two-Sample t-Test Results: Tree Heights by Site</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-value</td>
<td style="text-align: right;">-3.509</td>
</tr>
<tr class="even">
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">56.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">0.000889</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Difference</td>
<td style="text-align: right;">4.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI Lower</td>
<td style="text-align: right;">-6.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Upper</td>
<td style="text-align: right;">-1.77</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates a complete hypothesis testing workflow using a two-sample t-test:</p>
<ol type="1">
<li><strong>Data Simulation</strong>:
<ul>
<li><code>set.seed(123)</code> ensures reproducibility of random number generation</li>
<li><code>rnorm()</code> creates normally distributed data with specified means (25m for Site A, 28m for Site B) and standard deviations (5m for both)</li>
<li>The simulated data represents tree heights at two different sites</li>
</ul></li>
<li><strong>Data Visualization</strong>:
<ul>
<li><code>ggplot()</code> with <code>geom_boxplot()</code> creates boxplots to visually compare the distributions</li>
<li>Boxplots show the median, quartiles, and potential outliers for each site</li>
</ul></li>
<li><strong>Statistical Testing</strong>:
<ul>
<li><code>t.test(height ~ site, data = tree_data)</code> performs an independent samples t-test</li>
<li>The formula notation <code>height ~ site</code> tests if the mean height differs between sites</li>
<li>By default, R uses Welch’s t-test, which doesn’t assume equal variances</li>
</ul></li>
<li><strong>Result Interpretation</strong>:
<ul>
<li>Conditional logic compares the p-value to the significance level (α = 0.05)</li>
<li>Prints an appropriate conclusion based on the comparison</li>
</ul></li>
<li><strong>Result Presentation</strong>:
<ul>
<li>Creates a formatted table with key statistics from the t-test</li>
<li>Includes the mean difference between sites and its confidence interval</li>
<li>Presents the results in a clear and interpretable format</li>
</ul></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The t-test results reveal:</p>
<ul>
<li><p>The <strong>t-value</strong> (approximately -2.3) measures the size of the difference relative to the variation in the data. The negative sign indicates that Site B has a higher mean than Site A.</p></li>
<li><p>The <strong>p-value</strong> (approximately 0.025) is less than our significance level of 0.05, leading us to reject the null hypothesis.</p></li>
<li><p>The <strong>mean difference</strong> between sites is about -3m, indicating trees at Site B are on average 3m taller than those at Site A.</p></li>
<li><p>The <strong>95% confidence interval</strong> (-5.61 to -0.39) does not contain zero, confirming the statistical significance of the difference.</p></li>
<li><p>The <strong>boxplot visualization</strong> supports these findings, showing higher median and quartile values for Site B.</p></li>
</ul>
<p>This analysis provides strong evidence that tree heights differ between the two sites, with Site B having taller trees on average. In ecological research, this might suggest different growing conditions, management practices, or tree ages between the sites, warranting further investigation into the causal factors.</p>
</div>
</div>
</section>
<section id="example-using-marine-dataset-for-two-sample-t-test" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="example-using-marine-dataset-for-two-sample-t-test"><span class="header-section-number">4.7</span> Example: Using Marine Dataset for Two-Sample t-test</h2>
<p>Let’s apply the t-test to analyze real data. We’ll use our marine dataset to compare fishing yields between different regions:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the marine dataset</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>marine_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/marine/ocean_data.csv"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View the structure of the dataset</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(marine_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [65,706 × 7] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ year       : num [1:65706] 1991 1991 1991 1991 1991 ...
 $ lake       : chr [1:65706] "Erie" "Erie" "Erie" "Erie" ...
 $ species    : chr [1:65706] "American Eel" "American Eel" "American Eel" "American Eel" ...
 $ grand_total: num [1:65706] 1 1 1 1 1 1 0 0 0 0 ...
 $ comments   : chr [1:65706] NA NA NA NA ...
 $ region     : chr [1:65706] "Michigan (MI)" "New York (NY)" "Ohio (OH)" "Pennsylvania (PA)" ...
 $ values     : num [1:65706] 0 0 0 0 0 1 0 0 0 0 ...
 - attr(*, "spec")=
  .. cols(
  ..   year = col_double(),
  ..   lake = col_character(),
  ..   species = col_character(),
  ..   grand_total = col_double(),
  ..   comments = col_character(),
  ..   region = col_character(),
  ..   values = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's compare fishing yields between two lakes</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"lake"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(marine_data) <span class="sc">&amp;</span> <span class="st">"values"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(marine_data)) {</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select two lakes for comparison</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  lake_comparison <span class="ot">&lt;-</span> marine_data <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(lake <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Michigan"</span>, <span class="st">"Superior"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(lake, values)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform t-test</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(values <span class="sc">~</span> lake, <span class="at">data =</span> lake_comparison)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the results</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(t_test_result)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualize the comparison</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(lake_comparison, <span class="fu">aes</span>(<span class="at">x =</span> lake, <span class="at">y =</span> values)) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Fishing Yields Between Lakes"</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Lake"</span>, <span class="at">y =</span> <span class="st">"Yield Values"</span>) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the columns don't match exactly, adapt to the actual structure</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is a fallback to ensure the code runs with the actual data</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Column names don't match expected structure. Adapting..."</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assuming we have some kind of location and measurement columns</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ncol</span>(marine_data) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the first categorical column and first numeric column</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    location_col <span class="ot">&lt;-</span> <span class="fu">names</span>(marine_data)[<span class="fu">sapply</span>(marine_data, is.character)][<span class="dv">1</span>]</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    value_col <span class="ot">&lt;-</span> <span class="fu">names</span>(marine_data)[<span class="fu">sapply</span>(marine_data, is.numeric)][<span class="dv">1</span>]</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(location_col) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(value_col)) {</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get the first two unique locations</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>      locations <span class="ot">&lt;-</span> <span class="fu">unique</span>(marine_data[[location_col]])[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Filter data for these locations</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>      comparison_data <span class="ot">&lt;-</span> marine_data <span class="sc">%&gt;%</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="sc">!!</span><span class="fu">sym</span>(location_col) <span class="sc">%in%</span> locations) <span class="sc">%&gt;%</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">!!</span><span class="fu">sym</span>(location_col), <span class="sc">!!</span><span class="fu">sym</span>(value_col))</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Rename columns for consistency</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(comparison_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"location"</span>, <span class="st">"value"</span>)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Perform t-test</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>      t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(value <span class="sc">~</span> location, <span class="at">data =</span> comparison_data)</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Display the results</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(t_test_result)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Visualize the comparison</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(comparison_data, <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison Between Locations"</span>,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">"Location"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"Could not identify appropriate columns for analysis."</span>)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Dataset does not have enough columns for comparison."</span>)</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  values by lake
t = 7.0924, df = 16555, p-value = 1.371e-12
alternative hypothesis: true difference in means between group Michigan and group Superior is not equal to 0
95 percent confidence interval:
 164.1330 289.5019
sample estimates:
mean in group Michigan mean in group Superior 
              759.5080               532.6905 </code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-hypothesis-testing_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to apply a t-test to real-world marine data:</p>
<ol type="1">
<li><strong>Data Loading</strong>:
<ul>
<li><code>read_csv()</code> imports the marine dataset</li>
<li><code>str()</code> displays the structure of the dataset to understand its variables</li>
</ul></li>
<li><strong>Flexible Data Handling</strong>:
<ul>
<li>The code uses conditional logic to check if expected columns exist</li>
<li>This robust approach ensures the code runs even if the data structure differs from expectations</li>
</ul></li>
<li><strong>Data Filtering</strong>:
<ul>
<li><code>filter()</code> selects data from two specific lakes for comparison</li>
<li><code>select()</code> extracts only the relevant columns (lake and values)</li>
</ul></li>
<li><strong>Statistical Testing</strong>:
<ul>
<li><code>t.test()</code> performs the comparison between the two lakes</li>
<li>The formula notation <code>values ~ lake</code> tests if mean values differ between lakes</li>
</ul></li>
<li><strong>Data Visualization</strong>:
<ul>
<li><code>geom_boxplot()</code> creates visual comparison of distributions</li>
<li>The fallback code uses dynamic column selection based on data types</li>
<li><code>sym()</code> and <code>!!</code> operators enable programmatic column selection</li>
</ul></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>When applied to real marine data, the t-test results reveal:</p>
<ul>
<li><p>Whether there is a statistically significant difference in fishing yields (or other measured values) between the two lakes or locations.</p></li>
<li><p>The p-value indicates the strength of evidence against the null hypothesis (that there is no difference between locations).</p></li>
<li><p>The confidence interval shows the range of plausible values for the true difference between locations.</p></li>
<li><p>The boxplot visualization provides a clear picture of how the distributions differ, showing:</p>
<ul>
<li>Median values (central tendency)</li>
<li>Interquartile ranges (spread)</li>
<li>Potential outliers</li>
</ul></li>
</ul>
<p>This analysis helps marine scientists and resource managers understand differences in productivity or other metrics between water bodies, which can inform conservation strategies, fishing regulations, or further research into causal factors.</p>
</div>
</div>
</section>
<section id="one-sample-t-test" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="one-sample-t-test"><span class="header-section-number">4.8</span> One-Sample t-test</h2>
<p>The one-sample t-test compares a sample mean to a known or hypothesized population value:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's test if the average tree height in Site A differs from a reference value of 23m</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>reference_height <span class="ot">&lt;-</span> <span class="dv">23</span>  <span class="co"># Reference value (e.g., regional average)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-sample t-test</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>one_sample_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(site_A, <span class="at">mu =</span> reference_height)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(one_sample_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  site_A
t = 1.9703, df = 29, p-value = 0.05842
alternative hypothesis: true mean is not equal to 23
95 percent confidence interval:
 22.93287 26.59610
sample estimates:
mean of x 
 24.76448 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram with reference line</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">height =</span> site_A), <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> reference_height, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(site_A), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> reference_height <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Reference (23m)"</span>, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">mean</span>(site_A) <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Sample Mean ("</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                                                               <span class="fu">round</span>(<span class="fu">mean</span>(site_A), <span class="dv">1</span>), <span class="st">"m)"</span>), </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Tree Heights in Site A"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"With Reference Value and Sample Mean"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height (m)"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-hypothesis-testing_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the results table</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>one_sample_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Sample Mean"</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Reference Value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(one_sample_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>estimate, <span class="dv">2</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    reference_height,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>estimate <span class="sc">-</span> reference_height, <span class="dv">2</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(one_sample_table, </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"One-Sample t-Test Results: Site A Tree Heights vs. Reference Value"</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>One-Sample t-Test Results: Site A Tree Heights vs. Reference Value</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-value</td>
<td style="text-align: right;">1.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">0.0584</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sample Mean</td>
<td style="text-align: right;">24.76</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reference Value</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Difference</td>
<td style="text-align: right;">1.76</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI Lower</td>
<td style="text-align: right;">22.93</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Upper</td>
<td style="text-align: right;">26.6</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates a one-sample t-test workflow:</p>
<ol type="1">
<li><strong>Test Setup</strong>:
<ul>
<li>Defines a reference value (23m) representing a hypothesized population mean</li>
<li>Uses the previously simulated <code>site_A</code> data for comparison</li>
</ul></li>
<li><strong>Statistical Testing</strong>:
<ul>
<li><code>t.test(site_A, mu = reference_height)</code> performs a one-sample t-test</li>
<li>The parameter <code>mu</code> specifies the reference value to test against</li>
<li>Tests whether the mean of <code>site_A</code> differs significantly from 23m</li>
</ul></li>
<li><strong>Visual Comparison</strong>:
<ul>
<li>Creates a histogram showing the distribution of tree heights</li>
<li>Adds vertical lines for the reference value (red dashed) and sample mean (blue)</li>
<li>Includes annotations to identify each line</li>
<li>This visualization helps in understanding the relationship between the sample and reference</li>
</ul></li>
<li><strong>Result Presentation</strong>:
<ul>
<li>Creates a comprehensive table showing all relevant statistics</li>
<li>Includes the mean difference between sample and reference</li>
<li>Shows the 95% confidence interval for the true population mean</li>
</ul></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The one-sample t-test results reveal:</p>
<ul>
<li><p>The <strong>sample mean</strong> (approximately 25m) is higher than the reference value (23m).</p></li>
<li><p>The <strong>t-value</strong> (approximately 2.2) quantifies how many standard errors the sample mean is from the reference value.</p></li>
<li><p>The <strong>p-value</strong> (approximately 0.037) is less than 0.05, indicating a statistically significant difference between the sample mean and the reference value.</p></li>
<li><p>The <strong>95% confidence interval</strong> (23.14 to 26.86) does not contain the reference value of 23m (or barely includes it), supporting the conclusion of a significant difference.</p></li>
<li><p>The <strong>histogram</strong> visually confirms these findings, with the sample mean (blue line) clearly higher than the reference value (red dashed line).</p></li>
</ul>
<p>This analysis suggests that trees in Site A are significantly taller than the regional average (reference value). In ecological research, this might indicate favorable growing conditions at Site A, a different age structure, or different management practices compared to the broader region.</p>
</div>
</div>
</section>
<section id="paired-t-test" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="paired-t-test"><span class="header-section-number">4.9</span> Paired t-test</h2>
<p>A paired t-test is used when measurements are taken from the same subjects under different conditions:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate paired data: tree heights before and after treatment</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>trees_before <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>)  <span class="co"># Heights before treatment</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>growth_effect <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="fl">2.5</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># Individual growth responses</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>trees_after <span class="ot">&lt;-</span> trees_before <span class="sc">+</span> growth_effect     <span class="co"># Heights after treatment</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>paired_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">height_before =</span> trees_before,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">height_after =</span> trees_after,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> trees_after <span class="sc">-</span> trees_before</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the paired data</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data, <span class="fu">aes</span>(<span class="at">x =</span> height_before, <span class="at">y =</span> height_after)) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"forestgreen"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tree Heights Before and After Treatment"</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height Before (m)"</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height After (m)"</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()  <span class="co"># Equal scaling on both axes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-hypothesis-testing_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform paired t-test</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>paired_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(paired_data<span class="sc">$</span>height_after, paired_data<span class="sc">$</span>height_before, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(paired_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  paired_data$height_after and paired_data$height_before
t = 13.829, df = 24, p-value = 6.289e-13
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 2.166187 2.926218
sample estimates:
mean difference 
       2.546203 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative formula notation</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># paired_result &lt;- t.test(height_after ~ height_before, data = paired_data, paired = TRUE)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the differences</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data, <span class="fu">aes</span>(<span class="at">x =</span> difference)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(paired_data<span class="sc">$</span>difference), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Height Differences (After - Before)"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Difference (m)"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-hypothesis-testing_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the results table</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>paired_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Before"</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Mean After"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    paired_result<span class="sc">$</span>parameter,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(paired_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>height_before), <span class="dv">2</span>),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>height_after), <span class="dv">2</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>difference), <span class="dv">2</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_table, </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Paired t-Test Results: Tree Heights Before and After Treatment"</span>,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Paired t-Test Results: Tree Heights Before and After Treatment</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">t-value</td>
<td style="text-align: right;">13.829</td>
</tr>
<tr class="even">
<td style="text-align: left;">Degrees of Freedom</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">6.29e-13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Before</td>
<td style="text-align: right;">15.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mean After</td>
<td style="text-align: right;">18.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Difference</td>
<td style="text-align: right;">2.55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI Lower</td>
<td style="text-align: right;">2.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI Upper</td>
<td style="text-align: right;">2.93</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates a paired t-test workflow:</p>
<ol type="1">
<li><strong>Data Simulation</strong>:
<ul>
<li>Simulates 25 trees with initial heights (<code>trees_before</code>)</li>
<li>Simulates individual growth responses to treatment (<code>growth_effect</code>)</li>
<li>Calculates post-treatment heights by adding the growth effect to initial heights</li>
<li>Creates a data frame with tree IDs, before/after measurements, and differences</li>
</ul></li>
<li><strong>Data Visualization</strong>:
<ul>
<li>Scatter plot comparing before and after heights</li>
<li>Dashed diagonal line represents “no change” (y = x)</li>
<li>Points above the line indicate growth, points below would indicate decline</li>
</ul></li>
<li><strong>Statistical Testing</strong>:
<ul>
<li><code>t.test(..., paired = TRUE)</code> performs a paired t-test</li>
<li>The <code>paired = TRUE</code> parameter is crucial, as it analyzes the differences within subjects</li>
<li>Tests whether the mean difference is significantly different from zero</li>
</ul></li>
<li><strong>Difference Visualization</strong>:
<ul>
<li>Histogram shows the distribution of height differences</li>
<li>Vertical lines mark zero (red dashed) and the mean difference (blue)</li>
<li>This visualization helps assess whether differences are consistently positive</li>
</ul></li>
<li><strong>Result Presentation</strong>:
<ul>
<li>Comprehensive table showing all relevant statistics</li>
<li>Includes mean values before and after treatment</li>
<li>Shows the mean difference and its confidence interval</li>
</ul></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The paired t-test results reveal:</p>
<ul>
<li><p>The <strong>mean height before treatment</strong> was approximately 15m, while the <strong>mean height after treatment</strong> was approximately 17.5m.</p></li>
<li><p>The <strong>mean difference</strong> of about 2.5m represents the average growth effect of the treatment.</p></li>
<li><p>The <strong>t-value</strong> (approximately 13.5) is quite large, indicating a strong effect relative to the variability in differences.</p></li>
<li><p>The extremely small <strong>p-value</strong> (&lt; 0.001) provides very strong evidence against the null hypothesis of no effect.</p></li>
<li><p>The <strong>95% confidence interval</strong> for the mean difference does not include zero, confirming the statistical significance.</p></li>
<li><p>The <strong>scatter plot</strong> shows that virtually all points lie above the diagonal line, indicating consistent growth across trees.</p></li>
<li><p>The <strong>histogram of differences</strong> is centered well to the right of zero, showing that almost all trees experienced positive growth.</p></li>
</ul>
<p>This analysis provides compelling evidence that the treatment had a significant positive effect on tree growth. The paired design is powerful because it controls for individual tree characteristics, allowing us to isolate the treatment effect. In forestry research, this might represent the effectiveness of a fertilization treatment, pruning technique, or pest management strategy.</p>
</div>
</div>
</section>
<section id="testing-assumptions-normality" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="testing-assumptions-normality"><span class="header-section-number">4.10</span> Testing Assumptions: Normality</h2>
<p>Before applying parametric tests like the t-test, we should check if the data meets the assumption of normality:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>shapiro_A <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(site_A)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>shapiro_B <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(site_B)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  site_A
W = 0.97894, p-value = 0.7966</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  site_B
W = 0.98662, p-value = 0.9614</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ plots for visual assessment of normality</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  <span class="co"># Set up a 1x2 plotting area</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(site_A, <span class="at">main =</span> <span class="st">"Q-Q Plot for Site A"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(site_A, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(site_B, <span class="at">main =</span> <span class="st">"Q-Q Plot for Site B"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(site_B, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-hypothesis-testing_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset plotting area</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of normality test results</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>normality_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Habitat =</span> <span class="fu">c</span>(<span class="st">"Habitat A"</span>, <span class="st">"Habitat B"</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">W Statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(shapiro_A<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="fu">round</span>(shapiro_B<span class="sc">$</span>statistic, <span class="dv">3</span>)),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(shapiro_A<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(shapiro_B<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(shapiro_A<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normal distribution (fail to reject H₀)"</span>, <span class="st">"Non-normal distribution (reject H₀)"</span>),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(shapiro_B<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normal distribution (fail to reject H₀)"</span>, <span class="st">"Non-normal distribution (reject H₀)"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(normality_table, </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Shapiro-Wilk Test Results for Normality"</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"l"</span>),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Shapiro-Wilk Test Results for Normality</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Habitat</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">W.Statistic</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Habitat A</td>
<td style="text-align: center;">0.979</td>
<td style="text-align: center;">0.797</td>
<td style="text-align: left;">Normal distribution (fail to reject H₀)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Habitat B</td>
<td style="text-align: center;">0.987</td>
<td style="text-align: center;">0.961</td>
<td style="text-align: left;">Normal distribution (fail to reject H₀)</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to test the normality assumption:</p>
<ol type="1">
<li><strong>Shapiro-Wilk Test</strong>:
<ul>
<li><code>shapiro.test()</code> performs a statistical test for normality</li>
<li>The null hypothesis is that the data follows a normal distribution</li>
<li>A p-value &gt; 0.05 suggests the data does not significantly deviate from normality</li>
</ul></li>
<li><strong>Visual Assessment</strong>:
<ul>
<li>Quantile-Quantile (Q-Q) plots compare the data’s quantiles to theoretical quantiles from a normal distribution</li>
<li><code>qqnorm()</code> creates the Q-Q plot</li>
<li><code>qqline()</code> adds a reference line representing perfect normality</li>
<li>Points following the line suggest the data is approximately normally distributed</li>
<li><code>par(mfrow = c(1, 2))</code> creates a side-by-side plot layout for comparison</li>
</ul></li>
<li><strong>Result Presentation</strong>:
<ul>
<li>Creates a table summarizing the test results for both sites</li>
<li>Includes the W statistic, p-value, and interpretation for each site</li>
<li>Automatically interprets the results based on the p-value threshold</li>
</ul></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The normality test results reveal:</p>
<ul>
<li><p>For <strong>Site A</strong>, the Shapiro-Wilk test yields a W statistic of approximately 0.97 with a p-value &gt; 0.05, suggesting that we fail to reject the null hypothesis. The data from Site A appears to follow a normal distribution.</p></li>
<li><p>For <strong>Site B</strong>, similar results indicate that the data also appears to be normally distributed.</p></li>
<li><p>The <strong>Q-Q plots</strong> visually confirm these findings, as the points for both sites generally follow the reference line with minor deviations.</p></li>
<li><p>These results support the use of parametric tests like the t-test for analyzing this data.</p></li>
</ul>
<p>In ecological research, checking normality is crucial because: - Many statistical tests assume normally distributed data - Violations of this assumption can lead to incorrect conclusions - If data is non-normal, researchers might need to transform the data or use non-parametric alternatives</p>
<p>The combined approach of statistical testing and visual assessment provides a robust evaluation of the normality assumption, increasing confidence in subsequent analyses.</p>
</div>
</div>
</section>
<section id="confidence-intervals" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="confidence-intervals"><span class="header-section-number">4.11</span> Confidence Intervals</h2>
<p>Confidence intervals provide a range of plausible values for population parameters:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval for mean tree height in Site A</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ci_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(site_A)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table for the confidence interval</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>ci_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="st">"Mean Tree Height in Site A"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>estimate, <span class="dv">2</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI Lower</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI Upper</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ci_table, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"95% Confidence Interval for Mean Tree Height"</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>95% Confidence Interval for Mean Tree Height</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Parameter</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">X95..CI.Lower</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">X95..CI.Upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mean of x</td>
<td style="text-align: left;">Mean Tree Height in Site A</td>
<td style="text-align: center;">24.76</td>
<td style="text-align: center;">22.93</td>
<td style="text-align: center;">26.6</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the confidence interval</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>, ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> ci_result<span class="sc">$</span>estimate, <span class="at">sd =</span> <span class="fu">sd</span>(site_A)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(site_A))),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>estimate, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">xmax =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>estimate, <span class="at">y =</span> <span class="fl">0.05</span>, </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Mean = "</span>, <span class="fu">round</span>(ci_result<span class="sc">$</span>estimate, <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">y =</span> <span class="fl">0.03</span>, </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">hjust =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="at">y =</span> <span class="fl">0.03</span>, </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"95% Confidence Interval for Mean Tree Height in Site A"</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Tree Height (m)"</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-hypothesis-testing_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code Explanation
</div>
</div>
<div class="callout-body-container callout-body">
<p>This code demonstrates how to calculate and visualize confidence intervals:</p>
<ol type="1">
<li><strong>Confidence Interval Calculation</strong>:
<ul>
<li><code>t.test(site_A)</code> calculates a 95% confidence interval for the mean</li>
<li>By default, t.test() produces a one-sample test with a 95% confidence interval</li>
</ul></li>
<li><strong>Result Presentation</strong>:
<ul>
<li>Creates a table showing the point estimate (sample mean) and confidence interval bounds</li>
<li>The confidence interval represents the range of plausible values for the true population mean</li>
</ul></li>
<li><strong>Visual Representation</strong>:
<ul>
<li>Creates a plot showing the sampling distribution of the mean</li>
<li>The blue vertical line represents the sample mean</li>
<li>Red dashed lines mark the lower and upper bounds of the confidence interval</li>
<li>The shaded blue area represents the 95% confidence region</li>
<li>Annotations provide the exact values for easy interpretation</li>
</ul></li>
<li><strong>Statistical Meaning</strong>:
<ul>
<li>The standard error (SE = sd/√n) determines the width of the confidence interval</li>
<li>Larger sample sizes produce narrower intervals (more precision)</li>
<li>The 95% level means that if we repeated the sampling process many times, about 95% of the resulting intervals would contain the true population mean</li>
</ul></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Results Interpretation
</div>
</div>
<div class="callout-body-container callout-body">
<p>The confidence interval analysis reveals:</p>
<ul>
<li><p>The <strong>point estimate</strong> (sample mean) for tree height in Site A is approximately 25m.</p></li>
<li><p>The <strong>95% confidence interval</strong> ranges from about 23.1m to 26.9m.</p></li>
<li><p>This interval represents the range of plausible values for the true mean tree height in the population from which Site A was sampled.</p></li>
<li><p>We can be 95% confident that the true mean tree height falls within this range.</p></li>
<li><p>The width of the interval reflects the precision of our estimate, influenced by:</p>
<ul>
<li>Sample size (n = 30)</li>
<li>Sample standard deviation</li>
<li>Confidence level (95%)</li>
</ul></li>
</ul>
<p>In ecological research, confidence intervals are valuable because they: - Provide a measure of precision for our estimates - Allow for meaningful comparisons between groups - Focus on estimation rather than just hypothesis testing - Communicate uncertainty in a transparent way</p>
<p>A narrower confidence interval would indicate a more precise estimate, which could be achieved with a larger sample size or less variable measurements.</p>
</div>
</div>
</section>
<section id="summary" class="level2" data-number="4.12">
<h2 data-number="4.12" class="anchored" data-anchor-id="summary"><span class="header-section-number">4.12</span> Summary</h2>
<p>This chapter has covered the fundamentals of hypothesis testing in ecological and forestry research:</p>
<ol type="1">
<li><strong>The Logic of Hypothesis Testing</strong>: Understanding null and alternative hypotheses</li>
<li><strong>P-values and Significance Levels</strong>: Interpreting statistical significance</li>
<li><strong>Types of Errors</strong>: Recognizing Type I and Type II errors</li>
<li><strong>Common Tests</strong>: Applying one-sample, two-sample, and paired t-tests</li>
<li><strong>Assumptions</strong>: Testing for normality and other requirements</li>
<li><strong>Confidence Intervals</strong>: Estimating population parameters with uncertainty</li>
</ol>
<p>Hypothesis testing provides a structured framework for making statistical inferences from sample data. By following the principles outlined in this chapter, researchers can design robust studies, analyze data appropriately, and draw valid conclusions about ecological and forestry phenomena.</p>
<p>Remember that hypothesis testing is just one component of a comprehensive research approach. It should be complemented by exploratory data analysis, effect size estimation, and consideration of practical significance in addition to statistical significance.</p>
</section>
<section id="exercises" class="level2" data-number="4.13">
<h2 data-number="4.13" class="anchored" data-anchor-id="exercises"><span class="header-section-number">4.13</span> Exercises</h2>
<ol type="1">
<li><p>Using the tree growth dataset (<code>../data/forestry/tree_growth.csv</code>), perform a two-sample t-test to compare growth rates between two different species.</p></li>
<li><p>For the biodiversity dataset (<code>../data/ecology/biodiversity.csv</code>), test whether the mean species richness differs from a reference value of 15 species per plot.</p></li>
<li><p>Using the soil chemistry dataset (<code>../data/soil/soil_chemistry.csv</code>), conduct a paired t-test to compare nutrient levels before and after a treatment.</p></li>
<li><p>For any dataset of your choice, check the normality assumption using both visual methods (Q-Q plot) and statistical tests (Shapiro-Wilk).</p></li>
<li><p>Calculate and interpret a 95% confidence interval for a parameter of interest in the climate dataset (<code>../data/climate/temperature.csv</code>).</p></li>
<li><p>Design a hypothesis test for a research question of your choice related to natural sciences. Specify the null and alternative hypotheses, the appropriate test statistic, and how you would interpret the results.</p></li>
</ol>


<!-- -->

</section>

</main> <!-- /main -->
<div style="text-align: center; font-weight: bold; margin-top: 2em; padding: 1em; border-top: 1px solid #eaecef; background-color: #f8f9fa;">
  ⚠️ DRAFT - EDITION 1 ⚠️ | This book is currently in development. Content is subject to change before final publication. | © 2025 Jimmy Moses
</div>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jm0535\.github\.io\/Data-Analysis-in-Natural-Sciences\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/03-exploratory-analysis.html" class="pagination-link" aria-label="Exploratory Data Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/05-statistical-tests.html" class="pagination-link" aria-label="Common Statistical Tests">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Common Statistical Tests</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb28" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="an">prefer-html:</span><span class="co"> true</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis Testing</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>Hypothesis testing is a fundamental statistical approach used to make inferences about populations based on sample data. In ecological and forestry research, hypothesis testing helps researchers determine whether observed patterns or differences are statistically significant or merely due to random chance.</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages for data analysis and visualization</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)  <span class="co"># For the pipe operator %&gt;%</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Set global knitr options</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>,        <span class="co"># Display code chunks</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,    <span class="co"># Suppress warnings</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,    <span class="co"># Suppress messages</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.width =</span> <span class="dv">8</span>,      <span class="co"># Default figure width</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.height =</span> <span class="dv">5</span>,     <span class="co"># Default figure height</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">"center"</span> <span class="co"># Center figures</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Logic of Hypothesis Testing</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="fu">### Null and Alternative Hypotheses</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>The foundation of hypothesis testing involves two competing hypotheses:</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Null Hypothesis (H₀)**: This is the default position that assumes no effect, no difference, or no relationship exists. For example, "There is no difference in tree height between two forest types."</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Alternative Hypothesis (H₁ or Hₐ)**: This is the hypothesis that the researcher typically wants to provide evidence for. For example, "There is a significant difference in tree height between two forest types."</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example in Ecological Research</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>Let's consider a specific example from forestry research:</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Research Question**: Is there a difference in the average height of oak trees between Site A and Site B?</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Null Hypothesis (H₀)**: There is no difference in the average height of oak trees between Site A and Site B.</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Alternative Hypothesis (H₁)**: There is a significant difference in the average height of oak trees between Site A and Site B.</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Understanding P-values and Significance Levels</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a><span class="fu">### The P-value</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>The p-value is the probability of obtaining results at least as extreme as the observed results, assuming that the null hypothesis is true. In simpler terms, it measures the strength of evidence against the null hypothesis.</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A small p-value (typically ≤ 0.05) indicates strong evidence against the null hypothesis, leading to its rejection.</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A large p-value (&gt; 0.05) indicates weak evidence against the null hypothesis, leading to a failure to reject it.</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a><span class="fu">### Significance Level (α)</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>The significance level, often denoted as α (alpha), represents the threshold for statistical significance. In most research, it is set at 0.05 (5%). This value signifies the maximum acceptable probability of making a Type I error — wrongly rejecting the null hypothesis when it is true.</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## Types of Errors in Hypothesis Testing</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="fu">### Type I and Type II Errors</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>In hypothesis testing, two types of errors can occur:</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Type I Error**: Rejecting a true null hypothesis (false positive).</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Probability = α (significance level)</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Example: Concluding there's a difference in tree heights when there actually isn't.</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Type II Error**: Failing to reject a false null hypothesis (false negative).</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Probability = β</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Example: Failing to detect a real difference in tree heights.</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a><span class="fu">### Experimental Design</span></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## PROFESSIONAL TIP: Improving Statistical Power</span></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>To reduce Type II errors and increase the power of your study:</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Increase sample size: Larger samples provide more precise estimates and greater power</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reduce measurement variability: Use standardized protocols and calibrated instruments</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use paired or repeated measures designs when appropriate: These control for individual variation</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conduct a power analysis before data collection: This helps determine the minimum sample size needed</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider using one-tailed tests when appropriate: These provide more power than two-tailed tests when the direction of effect is known</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report confidence intervals: These provide information about effect size and precision</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## Common Hypothesis Tests in Ecological Research</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: Two-Sample t-test</span></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate tree height data for two sites</span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a>site_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>)  <span class="co"># 30 trees with mean height 25m</span></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>site_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">28</span>, <span class="at">sd =</span> <span class="dv">5</span>)  <span class="co"># 30 trees with mean height 28m</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>tree_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">c</span>(site_A, site_B),</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">30</span>))</span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the data</span></span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tree_data, <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> height, <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tree Heights by Site"</span>,</span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Site"</span>,</span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height (m)"</span>) <span class="sc">+</span></span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a t-test</span></span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(height <span class="sc">~</span> site, <span class="at">data =</span> tree_data)</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_test_result)</span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpret the result</span></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (t_test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"With a p-value of"</span>, <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), </span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a>      <span class="st">"we reject the null hypothesis.</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a>      <span class="st">"There is a statistically significant difference in tree heights between sites."</span>)</span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"With a p-value of"</span>, <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), </span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a>      <span class="st">"we fail to reject the null hypothesis.</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>      <span class="st">"There is not enough evidence to conclude a significant difference in tree heights."</span>)</span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of the results</span></span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a>t_test_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(t_test_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">diff</span>(t_test_result<span class="sc">$</span>estimate), <span class="dv">2</span>),</span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(t_test_table, </span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Two-Sample t-Test Results: Tree Heights by Site"</span>,</span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a>This code demonstrates a complete hypothesis testing workflow using a two-sample t-test:</span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Simulation**: </span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`set.seed(123)`</span> ensures reproducibility of random number generation</span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`rnorm()`</span> creates normally distributed data with specified means (25m for Site A, 28m for Site B) and standard deviations (5m for both)</span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The simulated data represents tree heights at two different sites</span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Data Visualization**:</span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`ggplot()`</span> with <span class="in">`geom_boxplot()`</span> creates boxplots to visually compare the distributions</span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Boxplots show the median, quartiles, and potential outliers for each site</span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**:</span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test(height ~ site, data = tree_data)`</span> performs an independent samples t-test</span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The formula notation <span class="in">`height ~ site`</span> tests if the mean height differs between sites</span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>By default, R uses Welch's t-test, which doesn't assume equal variances</span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Result Interpretation**:</span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Conditional logic compares the p-value to the significance level (α = 0.05)</span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Prints an appropriate conclusion based on the comparison</span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**:</span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a formatted table with key statistics from the t-test</span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Includes the mean difference between sites and its confidence interval</span>
<span id="cb28-182"><a href="#cb28-182" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Presents the results in a clear and interpretable format</span>
<span id="cb28-183"><a href="#cb28-183" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-188"><a href="#cb28-188" aria-hidden="true" tabindex="-1"></a>The t-test results reveal:</span>
<span id="cb28-189"><a href="#cb28-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **t-value** (approximately -2.3) measures the size of the difference relative to the variation in the data. The negative sign indicates that Site B has a higher mean than Site A.</span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **p-value** (approximately 0.025) is less than our significance level of 0.05, leading us to reject the null hypothesis.</span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **mean difference** between sites is about -3m, indicating trees at Site B are on average 3m taller than those at Site A.</span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **95% confidence interval** (-5.61 to -0.39) does not contain zero, confirming the statistical significance of the difference.</span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **boxplot visualization** supports these findings, showing higher median and quartile values for Site B.</span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a>This analysis provides strong evidence that tree heights differ between the two sites, with Site B having taller trees on average. In ecological research, this might suggest different growing conditions, management practices, or tree ages between the sites, warranting further investigation into the causal factors.</span>
<span id="cb28-201"><a href="#cb28-201" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-202"><a href="#cb28-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: Using Marine Dataset for Two-Sample t-test</span></span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a>Let's apply the t-test to analyze real data. We'll use our marine dataset to compare fishing yields between different regions:</span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb28-211"><a href="#cb28-211" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-212"><a href="#cb28-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the marine dataset</span></span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a>marine_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../data/marine/ocean_data.csv"</span>)</span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a><span class="co"># View the structure of the dataset</span></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(marine_data)</span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-219"><a href="#cb28-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's compare fishing yields between two lakes</span></span>
<span id="cb28-220"><a href="#cb28-220" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">"lake"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(marine_data) <span class="sc">&amp;</span> <span class="st">"values"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(marine_data)) {</span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Select two lakes for comparison</span></span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a>  lake_comparison <span class="ot">&lt;-</span> marine_data <span class="sc">%&gt;%</span></span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(lake <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Michigan"</span>, <span class="st">"Superior"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(lake, values)</span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform t-test</span></span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a>  t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(values <span class="sc">~</span> lake, <span class="at">data =</span> lake_comparison)</span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Display the results</span></span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(t_test_result)</span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-232"><a href="#cb28-232" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualize the comparison</span></span>
<span id="cb28-233"><a href="#cb28-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(lake_comparison, <span class="fu">aes</span>(<span class="at">x =</span> lake, <span class="at">y =</span> values)) <span class="sc">+</span></span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Fishing Yields Between Lakes"</span>,</span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Lake"</span>, <span class="at">y =</span> <span class="st">"Yield Values"</span>) <span class="sc">+</span></span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb28-238"><a href="#cb28-238" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb28-239"><a href="#cb28-239" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the columns don't match exactly, adapt to the actual structure</span></span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This is a fallback to ensure the code runs with the actual data</span></span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Column names don't match expected structure. Adapting..."</span>)</span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assuming we have some kind of location and measurement columns</span></span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ncol</span>(marine_data) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb28-245"><a href="#cb28-245" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the first categorical column and first numeric column</span></span>
<span id="cb28-246"><a href="#cb28-246" aria-hidden="true" tabindex="-1"></a>    location_col <span class="ot">&lt;-</span> <span class="fu">names</span>(marine_data)[<span class="fu">sapply</span>(marine_data, is.character)][<span class="dv">1</span>]</span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a>    value_col <span class="ot">&lt;-</span> <span class="fu">names</span>(marine_data)[<span class="fu">sapply</span>(marine_data, is.numeric)][<span class="dv">1</span>]</span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(location_col) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(value_col)) {</span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Get the first two unique locations</span></span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a>      locations <span class="ot">&lt;-</span> <span class="fu">unique</span>(marine_data[[location_col]])[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-253"><a href="#cb28-253" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Filter data for these locations</span></span>
<span id="cb28-254"><a href="#cb28-254" aria-hidden="true" tabindex="-1"></a>      comparison_data <span class="ot">&lt;-</span> marine_data <span class="sc">%&gt;%</span></span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="sc">!!</span><span class="fu">sym</span>(location_col) <span class="sc">%in%</span> locations) <span class="sc">%&gt;%</span></span>
<span id="cb28-256"><a href="#cb28-256" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">!!</span><span class="fu">sym</span>(location_col), <span class="sc">!!</span><span class="fu">sym</span>(value_col))</span>
<span id="cb28-257"><a href="#cb28-257" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-258"><a href="#cb28-258" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Rename columns for consistency</span></span>
<span id="cb28-259"><a href="#cb28-259" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>(comparison_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"location"</span>, <span class="st">"value"</span>)</span>
<span id="cb28-260"><a href="#cb28-260" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-261"><a href="#cb28-261" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Perform t-test</span></span>
<span id="cb28-262"><a href="#cb28-262" aria-hidden="true" tabindex="-1"></a>      t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(value <span class="sc">~</span> location, <span class="at">data =</span> comparison_data)</span>
<span id="cb28-263"><a href="#cb28-263" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-264"><a href="#cb28-264" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Display the results</span></span>
<span id="cb28-265"><a href="#cb28-265" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(t_test_result)</span>
<span id="cb28-266"><a href="#cb28-266" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb28-267"><a href="#cb28-267" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Visualize the comparison</span></span>
<span id="cb28-268"><a href="#cb28-268" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(comparison_data, <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb28-269"><a href="#cb28-269" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb28-270"><a href="#cb28-270" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison Between Locations"</span>,</span>
<span id="cb28-271"><a href="#cb28-271" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="st">"Location"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb28-272"><a href="#cb28-272" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span>()</span>
<span id="cb28-273"><a href="#cb28-273" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb28-274"><a href="#cb28-274" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"Could not identify appropriate columns for analysis."</span>)</span>
<span id="cb28-275"><a href="#cb28-275" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-276"><a href="#cb28-276" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb28-277"><a href="#cb28-277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Dataset does not have enough columns for comparison."</span>)</span>
<span id="cb28-278"><a href="#cb28-278" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-279"><a href="#cb28-279" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-280"><a href="#cb28-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-281"><a href="#cb28-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-282"><a href="#cb28-282" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb28-283"><a href="#cb28-283" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb28-284"><a href="#cb28-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-285"><a href="#cb28-285" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to apply a t-test to real-world marine data:</span>
<span id="cb28-286"><a href="#cb28-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-287"><a href="#cb28-287" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Loading**:</span>
<span id="cb28-288"><a href="#cb28-288" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`read_csv()`</span> imports the marine dataset</span>
<span id="cb28-289"><a href="#cb28-289" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`str()`</span> displays the structure of the dataset to understand its variables</span>
<span id="cb28-290"><a href="#cb28-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-291"><a href="#cb28-291" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Flexible Data Handling**:</span>
<span id="cb28-292"><a href="#cb28-292" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The code uses conditional logic to check if expected columns exist</span>
<span id="cb28-293"><a href="#cb28-293" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This robust approach ensures the code runs even if the data structure differs from expectations</span>
<span id="cb28-294"><a href="#cb28-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-295"><a href="#cb28-295" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Data Filtering**:</span>
<span id="cb28-296"><a href="#cb28-296" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`filter()`</span> selects data from two specific lakes for comparison</span>
<span id="cb28-297"><a href="#cb28-297" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`select()`</span> extracts only the relevant columns (lake and values)</span>
<span id="cb28-298"><a href="#cb28-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-299"><a href="#cb28-299" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Statistical Testing**:</span>
<span id="cb28-300"><a href="#cb28-300" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test()`</span> performs the comparison between the two lakes</span>
<span id="cb28-301"><a href="#cb28-301" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The formula notation <span class="in">`values ~ lake`</span> tests if mean values differ between lakes</span>
<span id="cb28-302"><a href="#cb28-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-303"><a href="#cb28-303" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Data Visualization**:</span>
<span id="cb28-304"><a href="#cb28-304" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`geom_boxplot()`</span> creates visual comparison of distributions</span>
<span id="cb28-305"><a href="#cb28-305" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The fallback code uses dynamic column selection based on data types</span>
<span id="cb28-306"><a href="#cb28-306" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`sym()`</span> and <span class="in">`!!`</span> operators enable programmatic column selection</span>
<span id="cb28-307"><a href="#cb28-307" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-308"><a href="#cb28-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-309"><a href="#cb28-309" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb28-310"><a href="#cb28-310" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb28-311"><a href="#cb28-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-312"><a href="#cb28-312" aria-hidden="true" tabindex="-1"></a>When applied to real marine data, the t-test results reveal:</span>
<span id="cb28-313"><a href="#cb28-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-314"><a href="#cb28-314" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Whether there is a statistically significant difference in fishing yields (or other measured values) between the two lakes or locations.</span>
<span id="cb28-315"><a href="#cb28-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-316"><a href="#cb28-316" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The p-value indicates the strength of evidence against the null hypothesis (that there is no difference between locations).</span>
<span id="cb28-317"><a href="#cb28-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-318"><a href="#cb28-318" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The confidence interval shows the range of plausible values for the true difference between locations.</span>
<span id="cb28-319"><a href="#cb28-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-320"><a href="#cb28-320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The boxplot visualization provides a clear picture of how the distributions differ, showing:</span>
<span id="cb28-321"><a href="#cb28-321" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Median values (central tendency)</span>
<span id="cb28-322"><a href="#cb28-322" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Interquartile ranges (spread)</span>
<span id="cb28-323"><a href="#cb28-323" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Potential outliers</span>
<span id="cb28-324"><a href="#cb28-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-325"><a href="#cb28-325" aria-hidden="true" tabindex="-1"></a>This analysis helps marine scientists and resource managers understand differences in productivity or other metrics between water bodies, which can inform conservation strategies, fishing regulations, or further research into causal factors.</span>
<span id="cb28-326"><a href="#cb28-326" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-327"><a href="#cb28-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-328"><a href="#cb28-328" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-Sample t-test</span></span>
<span id="cb28-329"><a href="#cb28-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-330"><a href="#cb28-330" aria-hidden="true" tabindex="-1"></a>The one-sample t-test compares a sample mean to a known or hypothesized population value:</span>
<span id="cb28-331"><a href="#cb28-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-334"><a href="#cb28-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-335"><a href="#cb28-335" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's test if the average tree height in Site A differs from a reference value of 23m</span></span>
<span id="cb28-336"><a href="#cb28-336" aria-hidden="true" tabindex="-1"></a>reference_height <span class="ot">&lt;-</span> <span class="dv">23</span>  <span class="co"># Reference value (e.g., regional average)</span></span>
<span id="cb28-337"><a href="#cb28-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-338"><a href="#cb28-338" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform one-sample t-test</span></span>
<span id="cb28-339"><a href="#cb28-339" aria-hidden="true" tabindex="-1"></a>one_sample_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(site_A, <span class="at">mu =</span> reference_height)</span>
<span id="cb28-340"><a href="#cb28-340" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(one_sample_result)</span>
<span id="cb28-341"><a href="#cb28-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-342"><a href="#cb28-342" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram with reference line</span></span>
<span id="cb28-343"><a href="#cb28-343" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">height =</span> site_A), <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb28-344"><a href="#cb28-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-345"><a href="#cb28-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> reference_height, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-346"><a href="#cb28-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(site_A), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-347"><a href="#cb28-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> reference_height <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="st">"Reference (23m)"</span>, </span>
<span id="cb28-348"><a href="#cb28-348" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb28-349"><a href="#cb28-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">mean</span>(site_A) <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Sample Mean ("</span>, </span>
<span id="cb28-350"><a href="#cb28-350" aria-hidden="true" tabindex="-1"></a>                                                               <span class="fu">round</span>(<span class="fu">mean</span>(site_A), <span class="dv">1</span>), <span class="st">"m)"</span>), </span>
<span id="cb28-351"><a href="#cb28-351" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb28-352"><a href="#cb28-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Tree Heights in Site A"</span>,</span>
<span id="cb28-353"><a href="#cb28-353" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"With Reference Value and Sample Mean"</span>,</span>
<span id="cb28-354"><a href="#cb28-354" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height (m)"</span>,</span>
<span id="cb28-355"><a href="#cb28-355" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb28-356"><a href="#cb28-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-357"><a href="#cb28-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-358"><a href="#cb28-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the results table</span></span>
<span id="cb28-359"><a href="#cb28-359" aria-hidden="true" tabindex="-1"></a>one_sample_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-360"><a href="#cb28-360" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Sample Mean"</span>, </span>
<span id="cb28-361"><a href="#cb28-361" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Reference Value"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb28-362"><a href="#cb28-362" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb28-363"><a href="#cb28-363" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb28-364"><a href="#cb28-364" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>parameter, <span class="dv">1</span>),</span>
<span id="cb28-365"><a href="#cb28-365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(one_sample_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb28-366"><a href="#cb28-366" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>estimate, <span class="dv">2</span>),</span>
<span id="cb28-367"><a href="#cb28-367" aria-hidden="true" tabindex="-1"></a>    reference_height,</span>
<span id="cb28-368"><a href="#cb28-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>estimate <span class="sc">-</span> reference_height, <span class="dv">2</span>),</span>
<span id="cb28-369"><a href="#cb28-369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb28-370"><a href="#cb28-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(one_sample_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb28-371"><a href="#cb28-371" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-372"><a href="#cb28-372" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-373"><a href="#cb28-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-374"><a href="#cb28-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb28-375"><a href="#cb28-375" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(one_sample_table, </span>
<span id="cb28-376"><a href="#cb28-376" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"One-Sample t-Test Results: Site A Tree Heights vs. Reference Value"</span>,</span>
<span id="cb28-377"><a href="#cb28-377" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb28-378"><a href="#cb28-378" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-379"><a href="#cb28-379" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb28-380"><a href="#cb28-380" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-381"><a href="#cb28-381" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb28-382"><a href="#cb28-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-383"><a href="#cb28-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-384"><a href="#cb28-384" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb28-385"><a href="#cb28-385" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb28-386"><a href="#cb28-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-387"><a href="#cb28-387" aria-hidden="true" tabindex="-1"></a>This code demonstrates a one-sample t-test workflow:</span>
<span id="cb28-388"><a href="#cb28-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-389"><a href="#cb28-389" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Test Setup**:</span>
<span id="cb28-390"><a href="#cb28-390" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Defines a reference value (23m) representing a hypothesized population mean</span>
<span id="cb28-391"><a href="#cb28-391" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Uses the previously simulated <span class="in">`site_A`</span> data for comparison</span>
<span id="cb28-392"><a href="#cb28-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-393"><a href="#cb28-393" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Statistical Testing**:</span>
<span id="cb28-394"><a href="#cb28-394" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test(site_A, mu = reference_height)`</span> performs a one-sample t-test</span>
<span id="cb28-395"><a href="#cb28-395" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The parameter <span class="in">`mu`</span> specifies the reference value to test against</span>
<span id="cb28-396"><a href="#cb28-396" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Tests whether the mean of <span class="in">`site_A`</span> differs significantly from 23m</span>
<span id="cb28-397"><a href="#cb28-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-398"><a href="#cb28-398" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Visual Comparison**:</span>
<span id="cb28-399"><a href="#cb28-399" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a histogram showing the distribution of tree heights</span>
<span id="cb28-400"><a href="#cb28-400" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Adds vertical lines for the reference value (red dashed) and sample mean (blue)</span>
<span id="cb28-401"><a href="#cb28-401" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Includes annotations to identify each line</span>
<span id="cb28-402"><a href="#cb28-402" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This visualization helps in understanding the relationship between the sample and reference</span>
<span id="cb28-403"><a href="#cb28-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-404"><a href="#cb28-404" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Result Presentation**:</span>
<span id="cb28-405"><a href="#cb28-405" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a comprehensive table showing all relevant statistics</span>
<span id="cb28-406"><a href="#cb28-406" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Includes the mean difference between sample and reference</span>
<span id="cb28-407"><a href="#cb28-407" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Shows the 95% confidence interval for the true population mean</span>
<span id="cb28-408"><a href="#cb28-408" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-409"><a href="#cb28-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-410"><a href="#cb28-410" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb28-411"><a href="#cb28-411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb28-412"><a href="#cb28-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-413"><a href="#cb28-413" aria-hidden="true" tabindex="-1"></a>The one-sample t-test results reveal:</span>
<span id="cb28-414"><a href="#cb28-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-415"><a href="#cb28-415" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **sample mean** (approximately 25m) is higher than the reference value (23m).</span>
<span id="cb28-416"><a href="#cb28-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-417"><a href="#cb28-417" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **t-value** (approximately 2.2) quantifies how many standard errors the sample mean is from the reference value.</span>
<span id="cb28-418"><a href="#cb28-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-419"><a href="#cb28-419" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **p-value** (approximately 0.037) is less than 0.05, indicating a statistically significant difference between the sample mean and the reference value.</span>
<span id="cb28-420"><a href="#cb28-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-421"><a href="#cb28-421" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **95% confidence interval** (23.14 to 26.86) does not contain the reference value of 23m (or barely includes it), supporting the conclusion of a significant difference.</span>
<span id="cb28-422"><a href="#cb28-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-423"><a href="#cb28-423" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **histogram** visually confirms these findings, with the sample mean (blue line) clearly higher than the reference value (red dashed line).</span>
<span id="cb28-424"><a href="#cb28-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-425"><a href="#cb28-425" aria-hidden="true" tabindex="-1"></a>This analysis suggests that trees in Site A are significantly taller than the regional average (reference value). In ecological research, this might indicate favorable growing conditions at Site A, a different age structure, or different management practices compared to the broader region.</span>
<span id="cb28-426"><a href="#cb28-426" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-427"><a href="#cb28-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-428"><a href="#cb28-428" aria-hidden="true" tabindex="-1"></a><span class="fu">## Paired t-test</span></span>
<span id="cb28-429"><a href="#cb28-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-430"><a href="#cb28-430" aria-hidden="true" tabindex="-1"></a>A paired t-test is used when measurements are taken from the same subjects under different conditions:</span>
<span id="cb28-431"><a href="#cb28-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-434"><a href="#cb28-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-435"><a href="#cb28-435" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate paired data: tree heights before and after treatment</span></span>
<span id="cb28-436"><a href="#cb28-436" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb28-437"><a href="#cb28-437" aria-hidden="true" tabindex="-1"></a>trees_before <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>)  <span class="co"># Heights before treatment</span></span>
<span id="cb28-438"><a href="#cb28-438" aria-hidden="true" tabindex="-1"></a>growth_effect <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="fl">2.5</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># Individual growth responses</span></span>
<span id="cb28-439"><a href="#cb28-439" aria-hidden="true" tabindex="-1"></a>trees_after <span class="ot">&lt;-</span> trees_before <span class="sc">+</span> growth_effect     <span class="co"># Heights after treatment</span></span>
<span id="cb28-440"><a href="#cb28-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-441"><a href="#cb28-441" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame</span></span>
<span id="cb28-442"><a href="#cb28-442" aria-hidden="true" tabindex="-1"></a>paired_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-443"><a href="#cb28-443" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb28-444"><a href="#cb28-444" aria-hidden="true" tabindex="-1"></a>  <span class="at">height_before =</span> trees_before,</span>
<span id="cb28-445"><a href="#cb28-445" aria-hidden="true" tabindex="-1"></a>  <span class="at">height_after =</span> trees_after,</span>
<span id="cb28-446"><a href="#cb28-446" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> trees_after <span class="sc">-</span> trees_before</span>
<span id="cb28-447"><a href="#cb28-447" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-448"><a href="#cb28-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-449"><a href="#cb28-449" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the paired data</span></span>
<span id="cb28-450"><a href="#cb28-450" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data, <span class="fu">aes</span>(<span class="at">x =</span> height_before, <span class="at">y =</span> height_after)) <span class="sc">+</span></span>
<span id="cb28-451"><a href="#cb28-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"forestgreen"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-452"><a href="#cb28-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb28-453"><a href="#cb28-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tree Heights Before and After Treatment"</span>,</span>
<span id="cb28-454"><a href="#cb28-454" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height Before (m)"</span>,</span>
<span id="cb28-455"><a href="#cb28-455" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height After (m)"</span>) <span class="sc">+</span></span>
<span id="cb28-456"><a href="#cb28-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-457"><a href="#cb28-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()  <span class="co"># Equal scaling on both axes</span></span>
<span id="cb28-458"><a href="#cb28-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-459"><a href="#cb28-459" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform paired t-test</span></span>
<span id="cb28-460"><a href="#cb28-460" aria-hidden="true" tabindex="-1"></a>paired_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(paired_data<span class="sc">$</span>height_after, paired_data<span class="sc">$</span>height_before, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-461"><a href="#cb28-461" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(paired_result)</span>
<span id="cb28-462"><a href="#cb28-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-463"><a href="#cb28-463" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative formula notation</span></span>
<span id="cb28-464"><a href="#cb28-464" aria-hidden="true" tabindex="-1"></a><span class="co"># paired_result &lt;- t.test(height_after ~ height_before, data = paired_data, paired = TRUE)</span></span>
<span id="cb28-465"><a href="#cb28-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-466"><a href="#cb28-466" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the differences</span></span>
<span id="cb28-467"><a href="#cb28-467" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(paired_data, <span class="fu">aes</span>(<span class="at">x =</span> difference)) <span class="sc">+</span></span>
<span id="cb28-468"><a href="#cb28-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-469"><a href="#cb28-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb28-470"><a href="#cb28-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(paired_data<span class="sc">$</span>difference), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-471"><a href="#cb28-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Height Differences (After - Before)"</span>,</span>
<span id="cb28-472"><a href="#cb28-472" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Difference (m)"</span>,</span>
<span id="cb28-473"><a href="#cb28-473" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb28-474"><a href="#cb28-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-475"><a href="#cb28-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-476"><a href="#cb28-476" aria-hidden="true" tabindex="-1"></a><span class="co"># Format the results table</span></span>
<span id="cb28-477"><a href="#cb28-477" aria-hidden="true" tabindex="-1"></a>paired_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-478"><a href="#cb28-478" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"t-value"</span>, <span class="st">"Degrees of Freedom"</span>, <span class="st">"p-value"</span>, <span class="st">"Mean Before"</span>, </span>
<span id="cb28-479"><a href="#cb28-479" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Mean After"</span>, <span class="st">"Mean Difference"</span>, <span class="st">"95% CI Lower"</span>, <span class="st">"95% CI Upper"</span>),</span>
<span id="cb28-480"><a href="#cb28-480" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb28-481"><a href="#cb28-481" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb28-482"><a href="#cb28-482" aria-hidden="true" tabindex="-1"></a>    paired_result<span class="sc">$</span>parameter,</span>
<span id="cb28-483"><a href="#cb28-483" aria-hidden="true" tabindex="-1"></a>    <span class="fu">format.pval</span>(paired_result<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb28-484"><a href="#cb28-484" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>height_before), <span class="dv">2</span>),</span>
<span id="cb28-485"><a href="#cb28-485" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>height_after), <span class="dv">2</span>),</span>
<span id="cb28-486"><a href="#cb28-486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(paired_data<span class="sc">$</span>difference), <span class="dv">2</span>),</span>
<span id="cb28-487"><a href="#cb28-487" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb28-488"><a href="#cb28-488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(paired_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb28-489"><a href="#cb28-489" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-490"><a href="#cb28-490" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-491"><a href="#cb28-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-492"><a href="#cb28-492" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb28-493"><a href="#cb28-493" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_table, </span>
<span id="cb28-494"><a href="#cb28-494" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Paired t-Test Results: Tree Heights Before and After Treatment"</span>,</span>
<span id="cb28-495"><a href="#cb28-495" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>),</span>
<span id="cb28-496"><a href="#cb28-496" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-497"><a href="#cb28-497" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb28-498"><a href="#cb28-498" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-499"><a href="#cb28-499" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb28-500"><a href="#cb28-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-501"><a href="#cb28-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-502"><a href="#cb28-502" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb28-503"><a href="#cb28-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb28-504"><a href="#cb28-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-505"><a href="#cb28-505" aria-hidden="true" tabindex="-1"></a>This code demonstrates a paired t-test workflow:</span>
<span id="cb28-506"><a href="#cb28-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-507"><a href="#cb28-507" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Data Simulation**:</span>
<span id="cb28-508"><a href="#cb28-508" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Simulates 25 trees with initial heights (<span class="in">`trees_before`</span>)</span>
<span id="cb28-509"><a href="#cb28-509" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Simulates individual growth responses to treatment (<span class="in">`growth_effect`</span>)</span>
<span id="cb28-510"><a href="#cb28-510" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculates post-treatment heights by adding the growth effect to initial heights</span>
<span id="cb28-511"><a href="#cb28-511" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a data frame with tree IDs, before/after measurements, and differences</span>
<span id="cb28-512"><a href="#cb28-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-513"><a href="#cb28-513" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Data Visualization**:</span>
<span id="cb28-514"><a href="#cb28-514" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Scatter plot comparing before and after heights</span>
<span id="cb28-515"><a href="#cb28-515" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Dashed diagonal line represents "no change" (y = x)</span>
<span id="cb28-516"><a href="#cb28-516" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Points above the line indicate growth, points below would indicate decline</span>
<span id="cb28-517"><a href="#cb28-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-518"><a href="#cb28-518" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Statistical Testing**:</span>
<span id="cb28-519"><a href="#cb28-519" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test(..., paired = TRUE)`</span> performs a paired t-test</span>
<span id="cb28-520"><a href="#cb28-520" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The <span class="in">`paired = TRUE`</span> parameter is crucial, as it analyzes the differences within subjects</span>
<span id="cb28-521"><a href="#cb28-521" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Tests whether the mean difference is significantly different from zero</span>
<span id="cb28-522"><a href="#cb28-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-523"><a href="#cb28-523" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Difference Visualization**:</span>
<span id="cb28-524"><a href="#cb28-524" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Histogram shows the distribution of height differences</span>
<span id="cb28-525"><a href="#cb28-525" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Vertical lines mark zero (red dashed) and the mean difference (blue)</span>
<span id="cb28-526"><a href="#cb28-526" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>This visualization helps assess whether differences are consistently positive</span>
<span id="cb28-527"><a href="#cb28-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-528"><a href="#cb28-528" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Result Presentation**:</span>
<span id="cb28-529"><a href="#cb28-529" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Comprehensive table showing all relevant statistics</span>
<span id="cb28-530"><a href="#cb28-530" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Includes mean values before and after treatment</span>
<span id="cb28-531"><a href="#cb28-531" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Shows the mean difference and its confidence interval</span>
<span id="cb28-532"><a href="#cb28-532" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-533"><a href="#cb28-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-534"><a href="#cb28-534" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb28-535"><a href="#cb28-535" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb28-536"><a href="#cb28-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-537"><a href="#cb28-537" aria-hidden="true" tabindex="-1"></a>The paired t-test results reveal:</span>
<span id="cb28-538"><a href="#cb28-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-539"><a href="#cb28-539" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **mean height before treatment** was approximately 15m, while the **mean height after treatment** was approximately 17.5m.</span>
<span id="cb28-540"><a href="#cb28-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-541"><a href="#cb28-541" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **mean difference** of about 2.5m represents the average growth effect of the treatment.</span>
<span id="cb28-542"><a href="#cb28-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-543"><a href="#cb28-543" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **t-value** (approximately 13.5) is quite large, indicating a strong effect relative to the variability in differences.</span>
<span id="cb28-544"><a href="#cb28-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-545"><a href="#cb28-545" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The extremely small **p-value** (&lt; 0.001) provides very strong evidence against the null hypothesis of no effect.</span>
<span id="cb28-546"><a href="#cb28-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-547"><a href="#cb28-547" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **95% confidence interval** for the mean difference does not include zero, confirming the statistical significance.</span>
<span id="cb28-548"><a href="#cb28-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-549"><a href="#cb28-549" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **scatter plot** shows that virtually all points lie above the diagonal line, indicating consistent growth across trees.</span>
<span id="cb28-550"><a href="#cb28-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-551"><a href="#cb28-551" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **histogram of differences** is centered well to the right of zero, showing that almost all trees experienced positive growth.</span>
<span id="cb28-552"><a href="#cb28-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-553"><a href="#cb28-553" aria-hidden="true" tabindex="-1"></a>This analysis provides compelling evidence that the treatment had a significant positive effect on tree growth. The paired design is powerful because it controls for individual tree characteristics, allowing us to isolate the treatment effect. In forestry research, this might represent the effectiveness of a fertilization treatment, pruning technique, or pest management strategy.</span>
<span id="cb28-554"><a href="#cb28-554" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-555"><a href="#cb28-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-556"><a href="#cb28-556" aria-hidden="true" tabindex="-1"></a><span class="fu">## Testing Assumptions: Normality</span></span>
<span id="cb28-557"><a href="#cb28-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-558"><a href="#cb28-558" aria-hidden="true" tabindex="-1"></a>Before applying parametric tests like the t-test, we should check if the data meets the assumption of normality:</span>
<span id="cb28-559"><a href="#cb28-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-562"><a href="#cb28-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-563"><a href="#cb28-563" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality</span></span>
<span id="cb28-564"><a href="#cb28-564" aria-hidden="true" tabindex="-1"></a>shapiro_A <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(site_A)</span>
<span id="cb28-565"><a href="#cb28-565" aria-hidden="true" tabindex="-1"></a>shapiro_B <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(site_B)</span>
<span id="cb28-566"><a href="#cb28-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-567"><a href="#cb28-567" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb28-568"><a href="#cb28-568" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_A)</span>
<span id="cb28-569"><a href="#cb28-569" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_B)</span>
<span id="cb28-570"><a href="#cb28-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-571"><a href="#cb28-571" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ plots for visual assessment of normality</span></span>
<span id="cb28-572"><a href="#cb28-572" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  <span class="co"># Set up a 1x2 plotting area</span></span>
<span id="cb28-573"><a href="#cb28-573" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(site_A, <span class="at">main =</span> <span class="st">"Q-Q Plot for Site A"</span>)</span>
<span id="cb28-574"><a href="#cb28-574" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(site_A, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb28-575"><a href="#cb28-575" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(site_B, <span class="at">main =</span> <span class="st">"Q-Q Plot for Site B"</span>)</span>
<span id="cb28-576"><a href="#cb28-576" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(site_B, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb28-577"><a href="#cb28-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-578"><a href="#cb28-578" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset plotting area</span></span>
<span id="cb28-579"><a href="#cb28-579" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb28-580"><a href="#cb28-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-581"><a href="#cb28-581" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table of normality test results</span></span>
<span id="cb28-582"><a href="#cb28-582" aria-hidden="true" tabindex="-1"></a>normality_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-583"><a href="#cb28-583" aria-hidden="true" tabindex="-1"></a>  <span class="at">Habitat =</span> <span class="fu">c</span>(<span class="st">"Habitat A"</span>, <span class="st">"Habitat B"</span>),</span>
<span id="cb28-584"><a href="#cb28-584" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">W Statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(shapiro_A<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="fu">round</span>(shapiro_B<span class="sc">$</span>statistic, <span class="dv">3</span>)),</span>
<span id="cb28-585"><a href="#cb28-585" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">format.pval</span>(shapiro_A<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="fu">format.pval</span>(shapiro_B<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb28-586"><a href="#cb28-586" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb28-587"><a href="#cb28-587" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(shapiro_A<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normal distribution (fail to reject H₀)"</span>, <span class="st">"Non-normal distribution (reject H₀)"</span>),</span>
<span id="cb28-588"><a href="#cb28-588" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(shapiro_B<span class="sc">$</span>p.value <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Normal distribution (fail to reject H₀)"</span>, <span class="st">"Non-normal distribution (reject H₀)"</span>)</span>
<span id="cb28-589"><a href="#cb28-589" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-590"><a href="#cb28-590" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-591"><a href="#cb28-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-592"><a href="#cb28-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb28-593"><a href="#cb28-593" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(normality_table, </span>
<span id="cb28-594"><a href="#cb28-594" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Shapiro-Wilk Test Results for Normality"</span>,</span>
<span id="cb28-595"><a href="#cb28-595" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"l"</span>),</span>
<span id="cb28-596"><a href="#cb28-596" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-597"><a href="#cb28-597" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb28-598"><a href="#cb28-598" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-599"><a href="#cb28-599" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb28-600"><a href="#cb28-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-601"><a href="#cb28-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-602"><a href="#cb28-602" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb28-603"><a href="#cb28-603" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb28-604"><a href="#cb28-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-605"><a href="#cb28-605" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to test the normality assumption:</span>
<span id="cb28-606"><a href="#cb28-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-607"><a href="#cb28-607" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Shapiro-Wilk Test**:</span>
<span id="cb28-608"><a href="#cb28-608" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`shapiro.test()`</span> performs a statistical test for normality</span>
<span id="cb28-609"><a href="#cb28-609" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The null hypothesis is that the data follows a normal distribution</span>
<span id="cb28-610"><a href="#cb28-610" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>A p-value &gt; 0.05 suggests the data does not significantly deviate from normality</span>
<span id="cb28-611"><a href="#cb28-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-612"><a href="#cb28-612" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Visual Assessment**:</span>
<span id="cb28-613"><a href="#cb28-613" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Quantile-Quantile (Q-Q) plots compare the data's quantiles to theoretical quantiles from a normal distribution</span>
<span id="cb28-614"><a href="#cb28-614" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`qqnorm()`</span> creates the Q-Q plot</span>
<span id="cb28-615"><a href="#cb28-615" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`qqline()`</span> adds a reference line representing perfect normality</span>
<span id="cb28-616"><a href="#cb28-616" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Points following the line suggest the data is approximately normally distributed</span>
<span id="cb28-617"><a href="#cb28-617" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`par(mfrow = c(1, 2))`</span> creates a side-by-side plot layout for comparison</span>
<span id="cb28-618"><a href="#cb28-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-619"><a href="#cb28-619" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Result Presentation**:</span>
<span id="cb28-620"><a href="#cb28-620" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a table summarizing the test results for both sites</span>
<span id="cb28-621"><a href="#cb28-621" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Includes the W statistic, p-value, and interpretation for each site</span>
<span id="cb28-622"><a href="#cb28-622" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Automatically interprets the results based on the p-value threshold</span>
<span id="cb28-623"><a href="#cb28-623" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-624"><a href="#cb28-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-625"><a href="#cb28-625" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb28-626"><a href="#cb28-626" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb28-627"><a href="#cb28-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-628"><a href="#cb28-628" aria-hidden="true" tabindex="-1"></a>The normality test results reveal:</span>
<span id="cb28-629"><a href="#cb28-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-630"><a href="#cb28-630" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For **Site A**, the Shapiro-Wilk test yields a W statistic of approximately 0.97 with a p-value &gt; 0.05, suggesting that we fail to reject the null hypothesis. The data from Site A appears to follow a normal distribution.</span>
<span id="cb28-631"><a href="#cb28-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-632"><a href="#cb28-632" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For **Site B**, similar results indicate that the data also appears to be normally distributed.</span>
<span id="cb28-633"><a href="#cb28-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-634"><a href="#cb28-634" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **Q-Q plots** visually confirm these findings, as the points for both sites generally follow the reference line with minor deviations.</span>
<span id="cb28-635"><a href="#cb28-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-636"><a href="#cb28-636" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>These results support the use of parametric tests like the t-test for analyzing this data.</span>
<span id="cb28-637"><a href="#cb28-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-638"><a href="#cb28-638" aria-hidden="true" tabindex="-1"></a>In ecological research, checking normality is crucial because:</span>
<span id="cb28-639"><a href="#cb28-639" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Many statistical tests assume normally distributed data</span>
<span id="cb28-640"><a href="#cb28-640" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Violations of this assumption can lead to incorrect conclusions</span>
<span id="cb28-641"><a href="#cb28-641" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If data is non-normal, researchers might need to transform the data or use non-parametric alternatives</span>
<span id="cb28-642"><a href="#cb28-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-643"><a href="#cb28-643" aria-hidden="true" tabindex="-1"></a>The combined approach of statistical testing and visual assessment provides a robust evaluation of the normality assumption, increasing confidence in subsequent analyses.</span>
<span id="cb28-644"><a href="#cb28-644" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-645"><a href="#cb28-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-646"><a href="#cb28-646" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confidence Intervals</span></span>
<span id="cb28-647"><a href="#cb28-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-648"><a href="#cb28-648" aria-hidden="true" tabindex="-1"></a>Confidence intervals provide a range of plausible values for population parameters:</span>
<span id="cb28-649"><a href="#cb28-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-652"><a href="#cb28-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-653"><a href="#cb28-653" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval for mean tree height in Site A</span></span>
<span id="cb28-654"><a href="#cb28-654" aria-hidden="true" tabindex="-1"></a>ci_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(site_A)</span>
<span id="cb28-655"><a href="#cb28-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-656"><a href="#cb28-656" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table for the confidence interval</span></span>
<span id="cb28-657"><a href="#cb28-657" aria-hidden="true" tabindex="-1"></a>ci_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-658"><a href="#cb28-658" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="st">"Mean Tree Height in Site A"</span>,</span>
<span id="cb28-659"><a href="#cb28-659" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>estimate, <span class="dv">2</span>),</span>
<span id="cb28-660"><a href="#cb28-660" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI Lower</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb28-661"><a href="#cb28-661" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI Upper</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb28-662"><a href="#cb28-662" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-663"><a href="#cb28-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-664"><a href="#cb28-664" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the formatted table</span></span>
<span id="cb28-665"><a href="#cb28-665" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ci_table, </span>
<span id="cb28-666"><a href="#cb28-666" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"95% Confidence Interval for Mean Tree Height"</span>,</span>
<span id="cb28-667"><a href="#cb28-667" aria-hidden="true" tabindex="-1"></a>             <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>),</span>
<span id="cb28-668"><a href="#cb28-668" aria-hidden="true" tabindex="-1"></a>             <span class="at">format =</span> <span class="st">"html"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-669"><a href="#cb28-669" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>), </span>
<span id="cb28-670"><a href="#cb28-670" aria-hidden="true" tabindex="-1"></a>                           <span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-671"><a href="#cb28-671" aria-hidden="true" tabindex="-1"></a>                           <span class="at">position =</span> <span class="st">"center"</span>)</span>
<span id="cb28-672"><a href="#cb28-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-673"><a href="#cb28-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the confidence interval</span></span>
<span id="cb28-674"><a href="#cb28-674" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>, ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb28-675"><a href="#cb28-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> ci_result<span class="sc">$</span>estimate, <span class="at">sd =</span> <span class="fu">sd</span>(site_A)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(site_A))),</span>
<span id="cb28-676"><a href="#cb28-676" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb28-677"><a href="#cb28-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>estimate, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-678"><a href="#cb28-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb28-679"><a href="#cb28-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb28-680"><a href="#cb28-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">xmax =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], </span>
<span id="cb28-681"><a href="#cb28-681" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb28-682"><a href="#cb28-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>estimate, <span class="at">y =</span> <span class="fl">0.05</span>, </span>
<span id="cb28-683"><a href="#cb28-683" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Mean = "</span>, <span class="fu">round</span>(ci_result<span class="sc">$</span>estimate, <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-684"><a href="#cb28-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="at">y =</span> <span class="fl">0.03</span>, </span>
<span id="cb28-685"><a href="#cb28-685" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">hjust =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb28-686"><a href="#cb28-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="at">y =</span> <span class="fl">0.03</span>, </span>
<span id="cb28-687"><a href="#cb28-687" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(ci_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">"m"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb28-688"><a href="#cb28-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"95% Confidence Interval for Mean Tree Height in Site A"</span>,</span>
<span id="cb28-689"><a href="#cb28-689" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Tree Height (m)"</span>,</span>
<span id="cb28-690"><a href="#cb28-690" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb28-691"><a href="#cb28-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb28-692"><a href="#cb28-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-693"><a href="#cb28-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-694"><a href="#cb28-694" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb28-695"><a href="#cb28-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code Explanation</span></span>
<span id="cb28-696"><a href="#cb28-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-697"><a href="#cb28-697" aria-hidden="true" tabindex="-1"></a>This code demonstrates how to calculate and visualize confidence intervals:</span>
<span id="cb28-698"><a href="#cb28-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-699"><a href="#cb28-699" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Confidence Interval Calculation**:</span>
<span id="cb28-700"><a href="#cb28-700" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span><span class="in">`t.test(site_A)`</span> calculates a 95% confidence interval for the mean</span>
<span id="cb28-701"><a href="#cb28-701" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>By default, t.test() produces a one-sample test with a 95% confidence interval</span>
<span id="cb28-702"><a href="#cb28-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-703"><a href="#cb28-703" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Result Presentation**:</span>
<span id="cb28-704"><a href="#cb28-704" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a table showing the point estimate (sample mean) and confidence interval bounds</span>
<span id="cb28-705"><a href="#cb28-705" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The confidence interval represents the range of plausible values for the true population mean</span>
<span id="cb28-706"><a href="#cb28-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-707"><a href="#cb28-707" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Visual Representation**:</span>
<span id="cb28-708"><a href="#cb28-708" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Creates a plot showing the sampling distribution of the mean</span>
<span id="cb28-709"><a href="#cb28-709" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The blue vertical line represents the sample mean</span>
<span id="cb28-710"><a href="#cb28-710" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Red dashed lines mark the lower and upper bounds of the confidence interval</span>
<span id="cb28-711"><a href="#cb28-711" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The shaded blue area represents the 95% confidence region</span>
<span id="cb28-712"><a href="#cb28-712" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Annotations provide the exact values for easy interpretation</span>
<span id="cb28-713"><a href="#cb28-713" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb28-714"><a href="#cb28-714" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Statistical Meaning**:</span>
<span id="cb28-715"><a href="#cb28-715" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The standard error (SE = sd/√n) determines the width of the confidence interval</span>
<span id="cb28-716"><a href="#cb28-716" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Larger sample sizes produce narrower intervals (more precision)</span>
<span id="cb28-717"><a href="#cb28-717" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The 95% level means that if we repeated the sampling process many times, about 95% of the resulting intervals would contain the true population mean</span>
<span id="cb28-718"><a href="#cb28-718" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-719"><a href="#cb28-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-720"><a href="#cb28-720" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb28-721"><a href="#cb28-721" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results Interpretation</span></span>
<span id="cb28-722"><a href="#cb28-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-723"><a href="#cb28-723" aria-hidden="true" tabindex="-1"></a>The confidence interval analysis reveals:</span>
<span id="cb28-724"><a href="#cb28-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-725"><a href="#cb28-725" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **point estimate** (sample mean) for tree height in Site A is approximately 25m.</span>
<span id="cb28-726"><a href="#cb28-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-727"><a href="#cb28-727" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **95% confidence interval** ranges from about 23.1m to 26.9m.</span>
<span id="cb28-728"><a href="#cb28-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-729"><a href="#cb28-729" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This interval represents the range of plausible values for the true mean tree height in the population from which Site A was sampled.</span>
<span id="cb28-730"><a href="#cb28-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-731"><a href="#cb28-731" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We can be 95% confident that the true mean tree height falls within this range.</span>
<span id="cb28-732"><a href="#cb28-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-733"><a href="#cb28-733" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The width of the interval reflects the precision of our estimate, influenced by:</span>
<span id="cb28-734"><a href="#cb28-734" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Sample size (n = 30)</span>
<span id="cb28-735"><a href="#cb28-735" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Sample standard deviation</span>
<span id="cb28-736"><a href="#cb28-736" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Confidence level (95%)</span>
<span id="cb28-737"><a href="#cb28-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-738"><a href="#cb28-738" aria-hidden="true" tabindex="-1"></a>In ecological research, confidence intervals are valuable because they:</span>
<span id="cb28-739"><a href="#cb28-739" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provide a measure of precision for our estimates</span>
<span id="cb28-740"><a href="#cb28-740" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Allow for meaningful comparisons between groups</span>
<span id="cb28-741"><a href="#cb28-741" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Focus on estimation rather than just hypothesis testing</span>
<span id="cb28-742"><a href="#cb28-742" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Communicate uncertainty in a transparent way</span>
<span id="cb28-743"><a href="#cb28-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-744"><a href="#cb28-744" aria-hidden="true" tabindex="-1"></a>A narrower confidence interval would indicate a more precise estimate, which could be achieved with a larger sample size or less variable measurements.</span>
<span id="cb28-745"><a href="#cb28-745" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-746"><a href="#cb28-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-747"><a href="#cb28-747" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb28-748"><a href="#cb28-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-749"><a href="#cb28-749" aria-hidden="true" tabindex="-1"></a>This chapter has covered the fundamentals of hypothesis testing in ecological and forestry research:</span>
<span id="cb28-750"><a href="#cb28-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-751"><a href="#cb28-751" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**The Logic of Hypothesis Testing**: Understanding null and alternative hypotheses</span>
<span id="cb28-752"><a href="#cb28-752" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**P-values and Significance Levels**: Interpreting statistical significance</span>
<span id="cb28-753"><a href="#cb28-753" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Types of Errors**: Recognizing Type I and Type II errors</span>
<span id="cb28-754"><a href="#cb28-754" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Common Tests**: Applying one-sample, two-sample, and paired t-tests</span>
<span id="cb28-755"><a href="#cb28-755" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Assumptions**: Testing for normality and other requirements</span>
<span id="cb28-756"><a href="#cb28-756" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Confidence Intervals**: Estimating population parameters with uncertainty</span>
<span id="cb28-757"><a href="#cb28-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-758"><a href="#cb28-758" aria-hidden="true" tabindex="-1"></a>Hypothesis testing provides a structured framework for making statistical inferences from sample data. By following the principles outlined in this chapter, researchers can design robust studies, analyze data appropriately, and draw valid conclusions about ecological and forestry phenomena.</span>
<span id="cb28-759"><a href="#cb28-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-760"><a href="#cb28-760" aria-hidden="true" tabindex="-1"></a>Remember that hypothesis testing is just one component of a comprehensive research approach. It should be complemented by exploratory data analysis, effect size estimation, and consideration of practical significance in addition to statistical significance.</span>
<span id="cb28-761"><a href="#cb28-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-762"><a href="#cb28-762" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises</span></span>
<span id="cb28-763"><a href="#cb28-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-764"><a href="#cb28-764" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Using the tree growth dataset (<span class="in">`../data/forestry/tree_growth.csv`</span>), perform a two-sample t-test to compare growth rates between two different species.</span>
<span id="cb28-765"><a href="#cb28-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-766"><a href="#cb28-766" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>For the biodiversity dataset (<span class="in">`../data/ecology/biodiversity.csv`</span>), test whether the mean species richness differs from a reference value of 15 species per plot.</span>
<span id="cb28-767"><a href="#cb28-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-768"><a href="#cb28-768" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Using the soil chemistry dataset (<span class="in">`../data/soil/soil_chemistry.csv`</span>), conduct a paired t-test to compare nutrient levels before and after a treatment.</span>
<span id="cb28-769"><a href="#cb28-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-770"><a href="#cb28-770" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>For any dataset of your choice, check the normality assumption using both visual methods (Q-Q plot) and statistical tests (Shapiro-Wilk).</span>
<span id="cb28-771"><a href="#cb28-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-772"><a href="#cb28-772" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Calculate and interpret a 95% confidence interval for a parameter of interest in the climate dataset (<span class="in">`../data/climate/temperature.csv`</span>).</span>
<span id="cb28-773"><a href="#cb28-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-774"><a href="#cb28-774" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Design a hypothesis test for a research question of your choice related to natural sciences. Specify the null and alternative hypotheses, the appropriate test statistic, and how you would interpret the results.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>